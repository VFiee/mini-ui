{"version":3,"file":"index.js","sources":["../../../packages/components/carousel/index.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { Swiper, SwiperItem, View, Text } from \"@tarojs/components\";\nimport Image from \"components/image\";\nimport { mergeStyle, isEmpty, compact, get } from \"utils\";\nimport {\n  IndicatorProps,\n  CarouselProps,\n  CarouselData,\n  ExtendSwiperItemPropsWithData,\n} from \"types\";\n\nconst IndicatorDots = (props: IndicatorProps) => {\n  const {\n    data,\n    style,\n    current,\n    className,\n    dotActiveLine,\n    indicatorColor,\n    wrapperClassName,\n    indicatorActiveColor,\n    ...restProps\n  } = props;\n  return (\n    <View className={wrapperClassName}>\n      {data.map((__, index) => {\n        const isCurrent: boolean = index === current;\n        const _style = mergeStyle(style, {\n          backgroundColor: isCurrent ? indicatorActiveColor : indicatorColor,\n        });\n        return (\n          <View\n            {...restProps}\n            key={index}\n            style={_style}\n            className={`__dot__ ${\n              isCurrent\n                ? `__dot__active__ ${\n                    dotActiveLine ? \"__dot__active__line__\" : \"\"\n                  }`\n                : \"\"\n            } ${className ?? \"\"}`}\n          ></View>\n        );\n      })}\n    </View>\n  );\n};\nconst IndicatorNumber = (props: IndicatorProps) => {\n  const { data, current, className, wrapperClassName, ...restProps } = props;\n  const extraText = get(data, `[${current}]._text`, \"\");\n  return (\n    <View className={wrapperClassName}>\n      <View {...restProps} className={`__numbers__ ${className ?? \"\"}`}>\n        <Text>\n          {current + 1}/{data.length}\n        </Text>\n        {extraText.length > 0 && (\n          <Text className=\"__extra__text__\">{extraText}</Text>\n        )}\n      </View>\n    </View>\n  );\n};\nconst defaultIndicator = {\n  indicatorType: \"dots\",\n  indicatorPosition: \"bottomCenter\",\n  indicatorColor: \"rgba(0, 0, 0, .3)\",\n  indicatorActiveColor: \"#000000\",\n};\nconst Indicator = (props: IndicatorProps) => {\n  const {\n    indicatorType,\n    indicatorPosition,\n    wrapperClassName = \"\",\n    ...restProps\n  } = {\n    ...defaultIndicator,\n    ...compact(props, (v) => typeof v === \"undefined\"),\n  };\n  const IndicatorComponent = get(\n    {\n      dots: IndicatorDots,\n      numbers: IndicatorNumber,\n    },\n    indicatorType,\n    IndicatorDots\n  );\n  return (\n    <IndicatorComponent\n      {...restProps}\n      wrapperClassName={`__indicator__ __indicator__${indicatorPosition} ${wrapperClassName}`}\n    />\n  );\n};\n\nconst CarouselItem = (props: ExtendSwiperItemPropsWithData) => {\n  const { data, onClick, extra, className = \"\", style, ...restProps } = props;\n  const { src } = data || {};\n  return (\n    <SwiperItem\n      {...restProps}\n      key={data.id}\n      className={`__swiper__item__ ${className}`}\n      onClick={onClick?.bind(null, data)}\n    >\n      <View className=\"__content__\">\n        <Image\n          src={src}\n          mode=\"aspectFit\"\n          errorIcon=\"icon-error_img\"\n          className=\"__carousel__img__\"\n        />\n      </View>\n      {extra?.(data)}\n    </SwiperItem>\n  );\n};\n\nconst Carousel = (props: CarouselProps) => {\n  const {\n    data,\n    style = \"\",\n    className = \"\",\n    swiperProps = {},\n    swiperItemProps,\n  } = props;\n  const {\n    onChange,\n    customIndicator,\n    onClick,\n    dotActiveLine,\n    wrapperClassName,\n    indicatorType,\n    indicatorPosition,\n    ...restProps\n  } = swiperProps;\n  const carouselData = (!isEmpty(data) ? data : [{}]) as CarouselData;\n  const [current, setCurrent] = useState(swiperProps?.current ?? 0);\n  const onSwiperChange = (eve) => {\n    setCurrent(eve.detail.current);\n    onChange?.call(null, eve);\n  };\n  return (\n    <View className={`__carousel__ ${className}`} style={style}>\n      <Swiper\n        {...restProps}\n        current={current}\n        onChange={onSwiperChange}\n        indicatorDots={!customIndicator && carouselData.length > 1}\n        className={`__swiper__ ${swiperProps?.className ?? \"\"}`}\n      >\n        {carouselData.map((item, index) => (\n          <CarouselItem\n            {...swiperItemProps}\n            key={index}\n            data={item}\n            onClick={onClick}\n          />\n        ))}\n      </Swiper>\n      {props?.extra}\n      {props?.children}\n      {!!(customIndicator && carouselData.length > 1) && (\n        <Indicator\n          {...{\n            current,\n            dotActiveLine,\n            indicatorType,\n            wrapperClassName,\n            indicatorPosition,\n            data: carouselData,\n            indicatorColor: swiperProps?.indicatorColor,\n            indicatorActiveColor: swiperProps?.indicatorActiveColor,\n          }}\n        />\n      )}\n    </View>\n  );\n};\n\nexport default Carousel;\n"],"names":[],"mappings":"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"}