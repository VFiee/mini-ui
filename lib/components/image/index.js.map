{"version":3,"file":"index.js","sources":["../../../packages/components/image/index.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { View, Image } from \"@tarojs/components\";\nimport Icon from \"components/icon\";\nimport { ImageProps } from \"types\";\n\nconst defaultImageProps: ImageProps = {\n  src: \"\",\n  showLoading: true,\n  loadingIcon: \"icon-morentu\",\n  showError: true,\n  errorIcon: \"icon-error_img\",\n} as ImageProps;\n\nconst Component = (props: ImageProps) => {\n  const {\n    showLoading,\n    loadingIcon,\n    loading,\n    showError,\n    errorIcon,\n    error,\n    round,\n    radius,\n    width,\n    height,\n    onLoad,\n    onError,\n    className,\n    style,\n    src,\n    ...restProps\n  } = {\n    ...defaultImageProps,\n    ...props,\n  };\n  const [status, setStatus] = useState({\n    loading: !!src,\n    error: !src,\n  });\n  function _onLoad(eve) {\n    setStatus({ loading: false, error: false });\n    onLoad && onLoad(eve);\n  }\n  function _onError(eve) {\n    setStatus({ loading: false, error: true });\n    onError && onError(eve);\n  }\n  function getStyle(_style) {\n    const baseStyle = {\n      width,\n      height,\n      borderRadius: radius,\n    };\n    if (!_style) return baseStyle;\n    return typeof _style === \"string\"\n      ? `${baseStyle}${style}`\n      : {\n          ...baseStyle,\n          ...(style as React.CSSProperties),\n        };\n  }\n\n  return (\n    <View\n      className={`__image__ ${round ? `__image__round__` : \"\"} ${\n        className || \"\"\n      }`}\n      style={getStyle(style)}\n    >\n      {!status.error && (\n        <Image\n          {...restProps}\n          src={src}\n          onLoad={_onLoad}\n          onError={_onError}\n          className=\"__image__origin__\"\n        />\n      )}\n      {showLoading && status.loading && (\n        <View className=\"__image__loading__\">\n          {loading ? (\n            loading\n          ) : (\n            <Icon type={loadingIcon as string} size=\"32px\" />\n          )}\n        </View>\n      )}\n      {showError && status.error && (\n        <View className=\"__image__error__\">\n          {error ? error : <Icon type={errorIcon as string} size=\"32px\" />}\n        </View>\n      )}\n    </View>\n  );\n};\n\nComponent.options = {\n  addGlobalClass: true,\n};\n\nexport default Component;\n"],"names":[],"mappings":";;;;;AAKA,IAAM,iBAAiB,GAAe;IACpC,GAAG,EAAE,EAAE;IACP,WAAW,EAAE,IAAI;IACjB,WAAW,EAAE,cAAc;IAC3B,SAAS,EAAE,IAAI;IACf,SAAS,EAAE,gBAAgB;CACd,CAAC;IAEV,SAAS,GAAG,UAAC,KAAiB;IAClC,IAAM,2BAkBD,iBAAiB,GACjB,KAAK,CACT,EAnBC,WAAW,iBAAA,EACX,WAAW,iBAAA,EACX,OAAO,aAAA,EACP,SAAS,eAAA,EACT,SAAS,eAAA,EACT,KAAK,WAAA,EACL,KAAK,WAAA,EACL,MAAM,YAAA,EACN,KAAK,WAAA,EACL,MAAM,YAAA,EACN,MAAM,YAAA,EACN,OAAO,aAAA,EACP,SAAS,eAAA,EACT,KAAK,WAAA,EACL,GAAG,SAAA,EACA,SAAS,cAhBR,oKAiBL,CAGA,CAAC;IACI,IAAA,KAAsB,QAAQ,CAAC;QACnC,OAAO,EAAE,CAAC,CAAC,GAAG;QACd,KAAK,EAAE,CAAC,GAAG;KACZ,CAAC,EAHK,MAAM,QAAA,EAAE,SAAS,QAGtB,CAAC;IACH,SAAS,OAAO,CAAC,GAAG;QAClB,SAAS,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAC5C,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC,CAAC;KACvB;IACD,SAAS,QAAQ,CAAC,GAAG;QACnB,SAAS,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QAC3C,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC;KACzB;IACD,SAAS,QAAQ,CAAC,MAAM;QACtB,IAAM,SAAS,GAAG;YAChB,KAAK,OAAA;YACL,MAAM,QAAA;YACN,YAAY,EAAE,MAAM;SACrB,CAAC;QACF,IAAI,CAAC,MAAM;YAAE,OAAO,SAAS,CAAC;QAC9B,OAAO,OAAO,MAAM,KAAK,QAAQ;cAC7B,KAAG,SAAS,GAAG,KAAO;oCAEjB,SAAS,GACR,KAA6B,CAClC,CAAC;KACP;IAED,QACE,oBAAC,IAAI,IACH,SAAS,EAAE,gBAAa,KAAK,GAAG,kBAAkB,GAAG,EAAE,WACrD,SAAS,IAAI,EAAE,CACf,EACF,KAAK,EAAE,QAAQ,CAAC,KAAK,CAAC;QAErB,CAAC,MAAM,CAAC,KAAK,KACZ,oBAAC,KAAK,eACA,SAAS,IACb,GAAG,EAAE,GAAG,EACR,MAAM,EAAE,OAAO,EACf,OAAO,EAAE,QAAQ,EACjB,SAAS,EAAC,mBAAmB,IAC7B,CACH;QACA,WAAW,IAAI,MAAM,CAAC,OAAO,KAC5B,oBAAC,IAAI,IAAC,SAAS,EAAC,oBAAoB,IACjC,OAAO,IACN,OAAO,KAEP,oBAAC,IAAI,IAAC,IAAI,EAAE,WAAqB,EAAE,IAAI,EAAC,MAAM,GAAG,CAClD,CACI,CACR;QACA,SAAS,IAAI,MAAM,CAAC,KAAK,KACxB,oBAAC,IAAI,IAAC,SAAS,EAAC,kBAAkB,IAC/B,KAAK,GAAG,KAAK,GAAG,oBAAC,IAAI,IAAC,IAAI,EAAE,SAAmB,EAAE,IAAI,EAAC,MAAM,GAAG,CAC3D,CACR,CACI,EACP;AACJ,EAAE;AAEF,SAAS,CAAC,OAAO,GAAG;IAClB,cAAc,EAAE,IAAI;CACrB;;;;"}